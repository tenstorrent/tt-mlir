execute_process(
  COMMAND python -c "from distutils import sysconfig; print(sysconfig.get_python_lib(prefix='', plat_specific=True))"
  OUTPUT_VARIABLE PYTHON_SITE_PACKAGES
  OUTPUT_STRIP_TRAILING_WHITESPACE)
set(TTMLIR_PYTHON_SITE_PACKAGES "${TTMLIR_TOOLCHAIN_DIR}/venv/${PYTHON_SITE_PACKAGES}" CACHE STRING "Path to the Python site-packages directory")

set(TTMLIR_TTRT_WHEEL_REQUIRES_DIST "torch==2.3.0" CACHE STRING "Requires-Dist entries for ttrt wheel")
if(NOT DEFINED TTMLIR_PYTHON_REQUIRES_DIST)
  set(TTMLIR_PYTHON_REQUIRES_DIST "")
endif()
list(APPEND TTMLIR_PYTHON_REQUIRES_DIST "${TTMLIR_TTRT_WHEEL_REQUIRES_DIST}")
set(TTMLIR_PYTHON_REQUIRES_DIST "${TTMLIR_PYTHON_REQUIRES_DIST}" CACHE STRING "Requires-Dist entries for TTMLIR wheels" FORCE)

set(TTMLIR_TTRT_WHEEL_REQUIRES_DIST_METADATA "")
foreach(requirement IN LISTS TTMLIR_PYTHON_REQUIRES_DIST)
  string(APPEND TTMLIR_TTRT_WHEEL_REQUIRES_DIST_METADATA "Requires-Dist: ${requirement}\n")
endforeach()
set(TTMLIR_TTRT_WHEEL_REQUIRES_DIST_METADATA "${TTMLIR_TTRT_WHEEL_REQUIRES_DIST_METADATA}" CACHE STRING "Requires-Dist metadata lines for ttrt wheel" FORCE)

set(TTMLIR_TTRT_WHEEL_REQUIRES_DIST_FILE "${CMAKE_CURRENT_BINARY_DIR}/ttrt-wheel-requires-dist.txt" CACHE FILEPATH "Requires-Dist metadata fragment for ttrt wheel" FORCE)
file(WRITE "${TTMLIR_TTRT_WHEEL_REQUIRES_DIST_FILE}" "${TTMLIR_TTRT_WHEEL_REQUIRES_DIST_METADATA}")
set_property(GLOBAL PROPERTY TTMLIR_TTRT_WHEEL_REQUIRES_DIST_FILE "${TTMLIR_TTRT_WHEEL_REQUIRES_DIST_FILE}")
