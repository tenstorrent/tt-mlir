// RUN: ttmlir-opt --ttir-implicit-broadcast-fold --ttir-fusing -o %t %s
// RUN: FileCheck %s --input-file=%t

module {
  func.func @main(%arg0: tensor<1x384x35x35xbf16>) -> tensor<1x384x35x35xbf16> {
    // CHECK-NOT: "ttir.constant"
    // CHECK: %[[POOLING:.*]] = "ttir.pooling"(%arg0
    // CHECK: return %[[POOLING]]
    // This constant is a tensor full of ones, padded with zeros to the top, bottom, left, and right with a thickness of 1
    %16 = "ttir.constant"() <{value = dense<"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F803F00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"> : tensor<37x37xbf16>}> : () -> tensor<37x37xbf16>
    %854 = ttir.empty() : tensor<1x384x37x37xbf16>
    %855 = "ttir.pad"(%arg0, %854) <{padding = array<i32: 0, 0, 0, 0, 1, 1, 1, 1>, value = 0.000000e+00 : f32}> : (tensor<1x384x35x35xbf16>, tensor<1x384x37x37xbf16>) -> tensor<1x384x37x37xbf16>
    %856 = ttir.empty() : tensor<1x384x35x35xbf16>
    %857 = "ttir.pooling"(%855, %856) <{base_dilations = array<i64: 1, 1, 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0, 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1, 1, 1>, window_dimensions = array<i64: 1, 1, 3, 3>, window_strides = array<i64: 1, 1, 1, 1>}> : (tensor<1x384x37x37xbf16>, tensor<1x384x35x35xbf16>) -> tensor<1x384x35x35xbf16>
    %858 = ttir.empty() : tensor<35x35xbf16>
    %859 = "ttir.pooling"(%16, %858) <{base_dilations = array<i64: 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1>, window_dimensions = array<i64: 3, 3>, window_strides = array<i64: 1, 1>}> : (tensor<37x37xbf16>, tensor<35x35xbf16>) -> tensor<35x35xbf16>
    %860 = ttir.empty() : tensor<1x1x35x35xbf16>
    %861 = "ttir.reshape"(%859, %860) <{shape = [1 : i32, 1 : i32, 35 : i32, 35 : i32]}> : (tensor<35x35xbf16>, tensor<1x1x35x35xbf16>) -> tensor<1x1x35x35xbf16>
    %862 = ttir.empty() : tensor<1x384x35x35xbf16>
    %863 = "ttir.broadcast"(%861, %862) <{broadcast_dimensions = array<i64: 1, 384, 1, 1>}> : (tensor<1x1x35x35xbf16>, tensor<1x384x35x35xbf16>) -> tensor<1x384x35x35xbf16>
    %864 = ttir.empty() : tensor<1x384x35x35xbf16>
    %865 = "ttir.div"(%857, %863, %864) : (tensor<1x384x35x35xbf16>, tensor<1x384x35x35xbf16>, tensor<1x384x35x35xbf16>) -> tensor<1x384x35x35xbf16>
    return %865  : tensor<1x384x35x35xbf16>
  }
}

module {
  func.func @main(%arg0: tensor<1x384x35x35xbf16>) -> tensor<1x384x35x35xbf16> {
    // CHECK-NOT: "ttir.full"
    // CHECK: %[[POOLING:.*]] = "ttir.pooling"(%arg0
    // CHECK: return %[[POOLING]]
    %16 = "ttir.full"() <{fill_value = 1.0 : f32, shape = array<i32: 37, 37>}> : () -> tensor<37x37xbf16>
    %856 = ttir.empty() : tensor<1x384x35x35xbf16>
    %857 = "ttir.pooling"(%arg0, %856) <{base_dilations = array<i64: 1, 1, 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0, 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1, 1, 1>, window_dimensions = array<i64: 1, 1, 3, 3>, window_strides = array<i64: 1, 1, 1, 1>}> : (tensor<1x384x35x35xbf16>, tensor<1x384x35x35xbf16>) -> tensor<1x384x35x35xbf16>
    %858 = ttir.empty() : tensor<35x35xbf16>
    %859 = "ttir.pooling"(%16, %858) <{base_dilations = array<i64: 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1>, window_dimensions = array<i64: 3, 3>, window_strides = array<i64: 1, 1>}> : (tensor<37x37xbf16>, tensor<35x35xbf16>) -> tensor<35x35xbf16>
    %860 = ttir.empty() : tensor<1x1x35x35xbf16>
    %861 = "ttir.reshape"(%859, %860) <{shape = [1 : i32, 1 : i32, 35 : i32, 35 : i32]}> : (tensor<35x35xbf16>, tensor<1x1x35x35xbf16>) -> tensor<1x1x35x35xbf16>
    %862 = ttir.empty() : tensor<1x384x35x35xbf16>
    %863 = "ttir.broadcast"(%861, %862) <{broadcast_dimensions = array<i64: 1, 384, 1, 1>}> : (tensor<1x1x35x35xbf16>, tensor<1x384x35x35xbf16>) -> tensor<1x384x35x35xbf16>
    %864 = ttir.empty() : tensor<1x384x35x35xbf16>
    %865 = "ttir.div"(%857, %863, %864) : (tensor<1x384x35x35xbf16>, tensor<1x384x35x35xbf16>, tensor<1x384x35x35xbf16>) -> tensor<1x384x35x35xbf16>
    return %865  : tensor<1x384x35x35xbf16>
  }
}

module {
  func.func @main(%arg0: tensor<1x384x35x35xi32>) -> tensor<1x384x35x35xi32> {
    // CHECK-NOT: "ttir.constant"
    // CHECK: %[[POOLING:.*]] = "ttir.pooling"(%arg0
    // CHECK: return %[[POOLING]]
    // This constant is a tensor full of ones, padded with zeros to the top, bottom, left, and right with a thickness of 1
    %16 = "ttir.constant"() <{value = dense<"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000000000000000000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000000000000000000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000100000001000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"> : tensor<37x37xi32>}> : () -> tensor<37x37xi32>
    %854 = ttir.empty() : tensor<1x384x37x37xi32>
    %855 = "ttir.pad"(%arg0, %854) <{padding = array<i32: 0, 0, 0, 0, 1, 1, 1, 1>, value = 0.000000e+00 : f32}> : (tensor<1x384x35x35xi32>, tensor<1x384x37x37xi32>) -> tensor<1x384x37x37xi32>
    %856 = ttir.empty() : tensor<1x384x35x35xi32>
    %857 = "ttir.pooling"(%855, %856) <{base_dilations = array<i64: 1, 1, 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0, 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1, 1, 1>, window_dimensions = array<i64: 1, 1, 3, 3>, window_strides = array<i64: 1, 1, 1, 1>}> : (tensor<1x384x37x37xi32>, tensor<1x384x35x35xi32>) -> tensor<1x384x35x35xi32>
    %858 = ttir.empty() : tensor<35x35xi32>
    %859 = "ttir.pooling"(%16, %858) <{base_dilations = array<i64: 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1>, window_dimensions = array<i64: 3, 3>, window_strides = array<i64: 1, 1>}> : (tensor<37x37xi32>, tensor<35x35xi32>) -> tensor<35x35xi32>
    %860 = ttir.empty() : tensor<1x1x35x35xi32>
    %861 = "ttir.reshape"(%859, %860) <{shape = [1 : i32, 1 : i32, 35 : i32, 35 : i32]}> : (tensor<35x35xi32>, tensor<1x1x35x35xi32>) -> tensor<1x1x35x35xi32>
    %862 = ttir.empty() : tensor<1x384x35x35xi32>
    %863 = "ttir.broadcast"(%861, %862) <{broadcast_dimensions = array<i64: 1, 384, 1, 1>}> : (tensor<1x1x35x35xi32>, tensor<1x384x35x35xi32>) -> tensor<1x384x35x35xi32>
    %864 = ttir.empty() : tensor<1x384x35x35xi32>
    %865 = "ttir.div"(%857, %863, %864) : (tensor<1x384x35x35xi32>, tensor<1x384x35x35xi32>, tensor<1x384x35x35xi32>) -> tensor<1x384x35x35xi32>
    return %865  : tensor<1x384x35x35xi32>
  }
}

module {
  func.func @main(%arg0: tensor<1x384x35x35xi32>) -> tensor<1x384x35x35xi32> {
    // CHECK-NOT: "ttir.full"
    // CHECK: %[[POOLING:.*]] = "ttir.pooling"(%arg0
    // CHECK: return %[[POOLING]]
    %16 = "ttir.full"() <{fill_value = 1.0 : f32, shape = array<i32: 37, 37>}> : () -> tensor<37x37xi32>
    %856 = ttir.empty() : tensor<1x384x35x35xi32>
    %857 = "ttir.pooling"(%arg0, %856) <{base_dilations = array<i64: 1, 1, 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0, 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1, 1, 1>, window_dimensions = array<i64: 1, 1, 3, 3>, window_strides = array<i64: 1, 1, 1, 1>}> : (tensor<1x384x35x35xi32>, tensor<1x384x35x35xi32>) -> tensor<1x384x35x35xi32>
    %858 = ttir.empty() : tensor<35x35xi32>
    %859 = "ttir.pooling"(%16, %858) <{base_dilations = array<i64: 1, 1>, operandSegmentSizes = array<i32: 1, 1>, padding = array<i64: 0, 0, 0, 0>, pooling_method = #ttir<pooling_method Sum>, window_dilations = array<i64: 1, 1>, window_dimensions = array<i64: 3, 3>, window_strides = array<i64: 1, 1>}> : (tensor<37x37xi32>, tensor<35x35xi32>) -> tensor<35x35xi32>
    %860 = ttir.empty() : tensor<1x1x35x35xi32>
    %861 = "ttir.reshape"(%859, %860) <{shape = [1 : i32, 1 : i32, 35 : i32, 35 : i32]}> : (tensor<35x35xi32>, tensor<1x1x35x35xi32>) -> tensor<1x1x35x35xi32>
    %862 = ttir.empty() : tensor<1x384x35x35xi32>
    %863 = "ttir.broadcast"(%861, %862) <{broadcast_dimensions = array<i64: 1, 384, 1, 1>}> : (tensor<1x1x35x35xi32>, tensor<1x384x35x35xi32>) -> tensor<1x384x35x35xi32>
    %864 = ttir.empty() : tensor<1x384x35x35xi32>
    %865 = "ttir.div"(%857, %863, %864) : (tensor<1x384x35x35xi32>, tensor<1x384x35x35xi32>, tensor<1x384x35x35xi32>) -> tensor<1x384x35x35xi32>
    return %865  : tensor<1x384x35x35xi32>
  }
}
